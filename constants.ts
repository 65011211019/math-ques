
import { Stage, Operation, Problem, PlayerStats, EnemySpecialAbility, DialogueLine, Cutscene, CutsceneFrame } from './types';

export const INITIAL_PLAYER_STATS: PlayerStats = {
  hp: 100,
  maxHp: 100,
  score: 0,
  hints: 3,
  potions: 2,
  focus: 0,
  maxFocus: 100,
};

export const POTION_HEAL_AMOUNT = 30;
export const COMBAT_TIMER_DURATION = 25; // Increased slightly
export const TIMER_PENALTY_DAMAGE = 10;

export const FOCUS_GAIN_ON_CORRECT = 20; // Adjusted
export const POWER_STRIKE_DAMAGE_MULTIPLIER = 1.6; // Adjusted
export const QUICK_ANSWER_THRESHOLD_SECONDS = 7; // Adjusted
export const QUICK_ANSWER_BONUS_SCORE = 5; // Adjusted

const getProblemSignature = (operand1: number, operand2: number, operation: Operation): string => {
  if (operation === Operation.ADD || operation === Operation.MULTIPLY) {
    return `${operation}_${Math.min(operand1, operand2)}_${Math.max(operand1, operand2)}`;
  }
  return `${operation}_${operand1}_${operand2}`;
};

// Generates a sequence of problems for a single enemy in a stage
function generateProblemsForStage(
  stageIdPrefix: string, // e.g., "s1"
  op: Operation | 'MIXED',
  numProblemsToGenerate: number,
  globalGeneratedProblemSignatures: Set<string>,
  problemDifficultyMultiplier: number = 1 // For scaling difficulty in later stages
): Problem[] {
  const problems: Problem[] = [];
  const stageSpecificSignatures = new Set<string>();
  const MAX_UNIQUE_ATTEMPTS_PER_PROBLEM = 100;

  for (let i = 0; i < numProblemsToGenerate; i++) {
    let operand1: number = 0, operand2: number = 0, correctAnswer: number = 0, text: string = '';
    let currentOperation = op;
    let attempts = 0;
    let problemSignature: string = '';
    let isProblemUnique = false;

    while (!isProblemUnique && attempts < MAX_UNIQUE_ATTEMPTS_PER_PROBLEM) {
      attempts++;
      if (op === 'MIXED') {
        const ops = [Operation.ADD, Operation.SUBTRACT, Operation.MULTIPLY, Operation.DIVIDE];
        currentOperation = ops[Math.floor(Math.random() * ops.length)];
      }

      let baseOperandRange = 20 * problemDifficultyMultiplier;
      let maxResult = 100 * problemDifficultyMultiplier;
      
      if (problemDifficultyMultiplier > 1.5) maxResult = 150 * problemDifficultyMultiplier;
      if (problemDifficultyMultiplier > 2.5) maxResult = 200 * problemDifficultyMultiplier;


      switch (currentOperation) {
        case Operation.ADD:
          operand1 = Math.floor(Math.random() * (baseOperandRange * 2)) + 1;
          operand2 = Math.floor(Math.random() * (baseOperandRange * 2)) + 1;
          if (operand1 + operand2 > maxResult) {
             operand2 = Math.max(1, Math.floor(Math.random() * (maxResult - operand1)));
             if (operand2 <=0) operand2 = 1;
          }
          correctAnswer = operand1 + operand2;
          text = `${operand1} + ${operand2} = ?`;
          break;
        case Operation.SUBTRACT:
          operand1 = Math.floor(Math.random() * maxResult) + Math.floor(baseOperandRange / 2) + 1;
          operand2 = Math.floor(Math.random() * (operand1 - 1)) + 1;
          if (operand2 >= operand1) operand2 = Math.max(1, operand1 - (Math.floor(Math.random()*5)+1));
          correctAnswer = operand1 - operand2;
          text = `${operand1} - ${operand2} = ?`;
          break;
        case Operation.MULTIPLY:
          let p1 = Math.floor(Math.random() * (10 + Math.floor(5 * problemDifficultyMultiplier))) + 1;
          let p2 = Math.floor(Math.random() * (10 + Math.floor(5 * problemDifficultyMultiplier))) + 1;
          if (p1 * p2 > maxResult) {
            p2 = Math.max(1, Math.floor(maxResult / p1));
          }
          if (p1 * p2 === 0) { p1 = Math.max(1, p1); p2 = Math.max(1, p2); }

          operand1 = p1;
          operand2 = p2;
          correctAnswer = operand1 * operand2;
          text = `${operand1} ${Operation.MULTIPLY} ${operand2} = ?`;
          break;
        case Operation.DIVIDE:
          let d_divisor = Math.floor(Math.random() * (10 + Math.floor(5*problemDifficultyMultiplier))) + 2;
          let d_quotient = Math.floor(Math.random() * (12 + Math.floor(5*problemDifficultyMultiplier))) + 1;
          if (d_quotient * d_divisor > maxResult) {
             d_quotient = Math.max(1, Math.floor(maxResult/d_divisor));
          }
          if (d_quotient * d_divisor === 0) {d_quotient = Math.max(1,d_quotient); d_divisor = Math.max(2,d_divisor);}
          
          operand1 = d_quotient * d_divisor;
          operand2 = d_divisor;
          correctAnswer = d_quotient;
          text = `${operand1} ${Operation.DIVIDE} ${operand2} = ?`;
          break;
        default: // Fallback to ADD
          operand1 = Math.floor(Math.random() * 20) + 1;
          operand2 = Math.floor(Math.random() * 20) + 1;
          correctAnswer = operand1 + operand2;
          text = `${operand1} + ${operand2} = ?`;
          currentOperation = Operation.ADD;
      }
      problemSignature = getProblemSignature(operand1, operand2, currentOperation as Operation);
      if (!stageSpecificSignatures.has(problemSignature) && !globalGeneratedProblemSignatures.has(problemSignature)) {
        isProblemUnique = true;
      }
    }

    if (isProblemUnique) {
      stageSpecificSignatures.add(problemSignature);
      globalGeneratedProblemSignatures.add(problemSignature);

      const options: number[] = [correctAnswer];
      while (options.length < 4) {
        let wrongOption;
        const delta = Math.floor(Math.random() * (10 + 5 * problemDifficultyMultiplier)) + 1;
        const plusMinus = Math.random() < 0.5 ? 1 : -1;
        if (Math.random() < 0.7) {
          wrongOption = correctAnswer + (delta * plusMinus);
        } else {
          wrongOption = Math.floor(Math.random() * Math.max(10, correctAnswer + (20 * problemDifficultyMultiplier))) + 1;
        }
        if (wrongOption <=0 && correctAnswer > 0) wrongOption = correctAnswer + delta;
        else if (wrongOption <= 0 && correctAnswer <=0) wrongOption = correctAnswer + delta + (correctAnswer === 0 ? 1 : 0);
        if (wrongOption === correctAnswer || options.includes(wrongOption)) continue;
        options.push(wrongOption);
      }
      problems.push({
        id: `${stageIdPrefix}-q${i}`,
        text,
        operand1,
        operand2,
        operation: currentOperation as Operation,
        correctAnswer,
        options: options.sort(() => Math.random() - 0.5),
      });
    } else {
      console.warn(`Could not generate unique problem for question ${i} in stage ${stageIdPrefix} after ${MAX_UNIQUE_ATTEMPTS_PER_PROBLEM} attempts. Stage might have fewer problems than intended.`);
    }
  }
  return problems;
}

// Define an intermediate type for stage configuration that includes problemDifficultyMultiplier
type StageConfigWithDifficulty = Omit<Stage, 'problems'> & {
  problemDifficultyMultiplier?: number;
};


export function initializeGameStages(): Stage[] {
  const globalGeneratedProblemSignatures = new Set<string>();

  const stagesData: StageConfigWithDifficulty[] = [
    // --- STAGE 1 ---
    {
      id: 's1', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ä‡∏≤‡∏¢‡∏õ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', worldName: '‡∏ä‡∏≤‡∏¢‡∏õ‡πà‡∏≤‡πÅ‡∏´‡πà‡∏á Numeria',
      description: '‡∏Å‡πâ‡∏≤‡∏ß‡πÅ‡∏£‡∏Å‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå! ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏õ‡∏£‡∏∞‡∏´‡∏•‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡∏£‡∏≠‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏ß‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà',
      operation: Operation.ADD, numProblems: 3, enemyName: '‡∏™‡πÑ‡∏•‡∏°‡πå‡∏ô‡πâ‡∏≠‡∏¢‡∏à‡∏≠‡∏°‡∏ã‡∏ô', enemySprite: 'üêå', enemyMaxHp: 40,
      companion: { name: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', advice: '‡∏Å‡∏≤‡∏£‡∏ö‡∏ß‡∏Å‡∏Ñ‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô! ‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏û‡∏•‡∏±‡∏á‡πÄ‡∏ß‡∏ó!', sprite: '‚ú®' },
      backgroundStyle: 'bg-green-100 border-green-500', mapIcon: 'üå≥',
      introDialogue: [
        { speakerSprite: '‚ú®', speakerName: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢', text: '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î! ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏†‡∏π‡∏ï‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤ ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏ä‡∏≤‡∏¢‡∏õ‡πà‡∏≤‡πÅ‡∏´‡πà‡∏á Numeria ‡∏ó‡∏µ‡πà‡∏ã‡∏∂‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô!' },
        { speakerSprite: '‚ú®', speakerName: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢', text: '‡∏î‡∏π‡∏ô‡∏±‡πà‡∏ô‡∏™‡∏¥! ‡∏™‡πÑ‡∏•‡∏°‡πå‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ç‡∏ß‡∏≤‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏π‡πà ‡∏à‡∏á‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏ß‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏±‡∏ô!' },
        { speakerSprite: 'üßô', speakerName: '‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î', text: '‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ç‡πâ‡∏≤‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°!' }
      ],
      outroDialogueWin: [ { speakerSprite: '‚ú®', speakerName: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢', text: '‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡πÄ‡∏à‡πâ‡∏≤‡∏°‡∏µ‡πÅ‡∏ß‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ú‡∏π‡πâ‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏ç‡πà! ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏∞!' } ],
      outroDialogueLose: [ { speakerSprite: '‚ú®', speakerName: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢', text: '‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£‡∏ô‡∏∞! ‡∏Å‡∏≤‡∏£‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ‡∏Ñ‡∏∑‡∏≠‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏™‡∏π‡πâ‡πÜ!' } ]
    },
    // --- STAGE 2 ---
    {
      id: 's2', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏•‡∏≥‡∏ò‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ã‡∏¥‡∏ö', worldName: '‡∏•‡∏≥‡∏ò‡∏≤‡∏£‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
      description: '‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Å‡∏£‡∏∞‡∏ã‡∏¥‡∏ö‡∏à‡∏≤‡∏Å‡∏•‡∏≥‡∏ò‡∏≤‡∏£‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤ ‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏ß‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏´‡πå‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà!',
      operation: Operation.SUBTRACT, numProblems: 4, enemyName: '‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏ß‡∏´‡∏¥‡∏ô‡∏à‡∏≠‡∏°‡∏Å‡∏ß‡∏ô', enemySprite: 'ü¶á', enemyMaxHp: 55,
      specialAbility: 'damageResist', abilityValue: 1,
      companion: { name: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', advice: '‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á! ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡πÄ‡∏Å‡∏£‡∏≤‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢!', sprite: '‚ú®' },
      backgroundStyle: 'bg-blue-100 border-blue-500', mapIcon: 'üèûÔ∏è',
      introDialogue: [
        { speakerSprite: '‚ú®', speakerName: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢', text: '‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏•‡∏≥‡∏ò‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ã‡∏¥‡∏ö‡πÅ‡∏•‡πâ‡∏ß... ‡∏ß‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏ß‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡πÑ‡∏°‡πà‡∏î‡∏µ‡∏ä‡∏≠‡∏ö‡πÅ‡∏Å‡∏•‡πâ‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏ô‡∏µ‡πâ' },
        { speakerSprite: 'ü¶á', speakerName: '‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏ß‡∏´‡∏¥‡∏ô', text: '‡πÉ‡∏Ñ‡∏£‡∏Å‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤! ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡πÇ‡∏î‡∏ô‡∏î‡∏µ‡∏ã‡∏∞‡πÄ‡∏ñ‡∏≠‡∏∞!' },
      ],
      outroDialogueWin: [ { speakerSprite: '‚ú®', speakerName: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢', text: '‡∏¢‡∏≠‡∏î‡πÑ‡∏õ‡πÄ‡∏•‡∏¢! ‡πÄ‡∏à‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏ß‡πÄ‡∏Å‡∏£‡∏≤‡∏∞‡∏ö‡∏≤‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å!' } ],
      outroDialogueLose: [ { speakerSprite: '‚ú®', speakerName: '‡∏†‡∏π‡∏ï‡∏ô‡πâ‡∏≠‡∏¢', text: '‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞! ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏î‡πâ!'}]
    },
    // --- STAGE 3 ---
    {
      id: 's3', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏õ‡πà‡∏≤‡∏•‡∏∂‡∏Å‡∏û‡∏¥‡∏®‡∏ß‡∏á', worldName: '‡∏õ‡πà‡∏≤‡∏Ñ‡∏π‡∏ì‡∏≠‡∏≤‡∏ñ‡∏£‡∏£‡∏û‡πå',
      description: '‡πÉ‡∏ô‡∏õ‡πà‡∏≤‡∏•‡∏∂‡∏Å ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏π‡∏ì‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡∏Å‡πá‡∏≠‡∏ö‡∏•‡∏¥‡∏ô‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏ó‡∏ß‡∏µ‡∏Ñ‡∏π‡∏ì‡πÇ‡∏à‡∏°‡∏ï‡∏µ!',
      operation: Operation.MULTIPLY, numProblems: 4, enemyName: '‡∏Å‡πá‡∏≠‡∏ö‡∏•‡∏¥‡∏ô‡∏ô‡∏±‡∏Å‡∏Ñ‡∏π‡∏ì', enemySprite: 'üë∫', enemyMaxHp: 70,
      companion: { name: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', advice: '‡∏Å‡∏≤‡∏£‡∏Ñ‡∏π‡∏ì‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏ß‡∏µ‡∏Ñ‡∏π‡∏ì! ‡∏à‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏î‡∏µ!', sprite: 'üå≥' },
      backgroundStyle: 'bg-yellow-100 border-yellow-500', mapIcon: 'üå≤',
      introDialogue: [
        { speakerSprite: 'üå≥', speakerName: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', text: '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏õ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤ ‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ô‡πâ‡∏≠‡∏¢... ‡∏Ç‡πâ‡∏≤‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡πÑ‡∏î‡πâ‡∏ñ‡∏∂‡∏á‡∏û‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏à‡πâ‡∏≤ ‡πÅ‡∏ï‡πà‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡πá‡∏≠‡∏ö‡∏•‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ ‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡∏π‡∏ì'},
        { speakerSprite: 'üë∫', speakerName: '‡∏Å‡πá‡∏≠‡∏ö‡∏•‡∏¥‡∏ô‡∏ô‡∏±‡∏Å‡∏Ñ‡∏π‡∏ì', text: '‡∏Æ‡πà‡∏≤‡πÜ‡πÜ! ‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß! ‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏à‡∏∞‡∏ó‡∏ß‡∏µ‡∏Ñ‡∏π‡∏ì‡∏à‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï!'}
      ],
      outroDialogueWin: [ { speakerSprite: 'üå≥', speakerName: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', text: '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠! ‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞‡πÄ‡∏ß‡∏ó‡∏Å‡∏≤‡∏£‡∏Ñ‡∏π‡∏ì‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÑ‡∏î‡πâ! ‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å‡∏à‡∏£‡∏¥‡∏á‡πÜ' } ],
      outroDialogueLose: [ { speakerSprite: 'üå≥', speakerName: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', text: '‡πÄ‡∏ß‡∏ó‡∏Å‡∏≤‡∏£‡∏Ñ‡∏π‡∏ì‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏£‡πâ‡∏≤‡∏¢‡∏Å‡∏≤‡∏à‡∏ô‡∏±‡∏Å ‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞'}]
    },
    // --- STAGE 4 ---
    {
      id: 's4', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ñ‡πâ‡∏≥‡∏ú‡∏•‡∏∂‡∏Å‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô', worldName: '‡∏ñ‡πâ‡∏≥‡∏´‡∏≤‡∏£‡∏™‡πà‡∏ß‡∏ô',
      description: '‡∏ñ‡πâ‡∏≥‡∏ú‡∏•‡∏∂‡∏Å‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£ ‡∏õ‡∏µ‡∏®‡∏≤‡∏à‡πÅ‡∏°‡∏á‡∏°‡∏∏‡∏°‡∏£‡∏≠‡πÅ‡∏ö‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤!',
      operation: Operation.DIVIDE, numProblems: 5, enemyName: '‡πÅ‡∏°‡∏á‡∏°‡∏∏‡∏°‡∏ú‡∏•‡∏∂‡∏Å‡∏à‡∏≠‡∏°‡πÅ‡∏ö‡πà‡∏á', enemySprite: 'üï∑Ô∏è', enemyMaxHp: 80,
      companion: { name: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', advice: '‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°! ‡∏à‡∏á‡∏´‡∏≤‡∏ß‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î!', sprite: 'üå≥' },
      backgroundStyle: 'bg-indigo-100 border-indigo-500', mapIcon: 'üí†',
      introDialogue: [
        { speakerSprite: 'üå≥', speakerName: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', text: '‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏ñ‡πâ‡∏≥‡∏ú‡∏•‡∏∂‡∏Å ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏ô‡∏°‡∏µ‡πÅ‡∏°‡∏á‡∏°‡∏∏‡∏°‡∏£‡πâ‡∏≤‡∏¢‡∏Å‡∏≤‡∏à‡πÄ‡∏ù‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà ‡∏°‡∏±‡∏ô‡∏ä‡∏≠‡∏ö‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏ö‡∏™‡∏ô'},
        { speakerSprite: 'üßô', speakerName: '‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î', text: '‡∏Ç‡πâ‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡∏°‡∏≤‡∏Ç‡∏ß‡∏≤‡∏á‡∏ó‡∏≤‡∏á‡∏Ç‡πâ‡∏≤‡πÅ‡∏ô‡πà!'}
      ],
      outroDialogueWin: [ { speakerSprite: 'üå≥', speakerName: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', text: '‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£‡∏Å‡πá‡πÑ‡∏°‡πà‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡πÑ‡∏î‡πâ! ‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß!' } ],
      outroDialogueLose: [ { speakerSprite: 'üå≥', speakerName: '‡∏†‡∏π‡∏ï‡∏û‡∏§‡∏Å‡∏©‡∏≤', text: '‡πÉ‡∏¢‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£‡πÄ‡∏•‡∏¢‡∏™‡∏¥‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡∏î‡∏π‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á!'}]
    },
    // --- STAGE 5 ---
    {
      id: 's5', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏ö‡∏™‡∏π‡∏á‡∏Ñ‡∏≥‡∏£‡∏≤‡∏°', worldName: '‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏ö‡∏™‡∏π‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
      description: '‡∏ö‡∏ó‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏£‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏°‡πà‡∏ó‡∏±‡∏û‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö! ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏∏‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤!',
      operation: 'MIXED', numProblems: 5, enemyName: '‡∏≠‡∏≠‡∏£‡πå‡∏Ñ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢', enemySprite: 'üêó', enemyMaxHp: 100,
      specialAbility: 'attackUpOnHit', abilityValue: 2, // Gets stronger each time it hits player
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå! ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏ß‡πâ!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-red-100 border-red-500', mapIcon: '‚õ∞Ô∏è',
      introDialogue: [
        { speakerSprite: 'ü¶â', speakerName: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', text: '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏π... ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡∏ú‡∏π‡πâ‡πÄ‡∏ù‡πâ‡∏≤‡∏î‡∏π‡∏î‡∏¥‡∏ô‡πÅ‡∏î‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏ô‡∏≤‡∏ô ‡πÄ‡∏à‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ñ‡∏∂‡∏á‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏ç‡πà' },
        { speakerSprite: 'ü¶â', speakerName: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', text: '‡πÅ‡∏ï‡πà‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠ ‡∏≠‡∏≠‡∏£‡πå‡∏Ñ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏Ç‡∏∏‡∏ô‡∏û‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤!' },
        { speakerSprite: 'üêó', speakerName: '‡∏≠‡∏≠‡∏£‡πå‡∏Ñ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢', text: '‡πÇ‡∏Æ‡∏Å‡∏Å‡∏Å! ‡πÄ‡∏à‡πâ‡∏≤‡∏Å‡∏•‡πâ‡∏≤‡∏î‡∏µ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà! ‡∏Ç‡πâ‡∏≤‡∏à‡∏∞‡∏ö‡∏î‡∏Ç‡∏¢‡∏µ‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏ã‡∏∞!'}
      ],
      outroDialogueWin: [ { speakerSprite: 'ü¶â', speakerName: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', text: '‡∏ô‡πà‡∏≤‡∏ó‡∏∂‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡πÄ‡∏à‡πâ‡∏≤‡∏•‡πâ‡∏°‡∏≠‡∏≠‡∏£‡πå‡∏Ñ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ! ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏´‡∏•‡∏ß‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß' } ],
      outroDialogueLose: [ { speakerSprite: 'ü¶â', speakerName: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', text: '‡∏°‡∏±‡∏ô‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏°‡∏≤‡∏Å... ‡∏Å‡∏≤‡∏£‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏ô‡∏•‡πâ‡∏≥‡∏Ñ‡πà‡∏≤' } ]
    },
    // --- STAGE 6 ---
    {
      id: 's6', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 6: ‡∏ó‡∏∞‡πÄ‡∏•‡∏ó‡∏£‡∏≤‡∏¢‡∏•‡∏ß‡∏á‡∏ï‡∏≤', worldName: '‡∏ó‡∏∞‡πÄ‡∏•‡∏ó‡∏£‡∏≤‡∏¢‡∏≠‡∏ô‡∏±‡∏ô‡∏ï‡πå',
      description: '‡∏†‡∏≤‡∏û‡∏•‡∏ß‡∏á‡∏ï‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏£‡∏∞‡∏≠‡∏∏ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á',
      operation: 'MIXED', numProblems: 6, enemyName: '‡∏†‡∏π‡∏ï‡∏¥‡∏ó‡∏£‡∏≤‡∏¢‡∏°‡∏≤‡∏¢‡∏≤', enemySprite: 'üèúÔ∏è', enemyMaxHp: 120,
      specialAbility: 'hpDrain', abilityValue: 3, // Drains HP each turn
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏≠‡∏¢‡πà‡∏≤‡∏´‡∏•‡∏á‡∏Å‡∏•‡∏†‡∏≤‡∏û‡∏•‡∏ß‡∏á‡∏ï‡∏≤! ‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡∏Å‡∏±‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-orange-100 border-orange-500', mapIcon: 'üåµ',
      introDialogue: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏ó‡∏∞‡πÄ‡∏•‡∏ó‡∏£‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏û‡∏•‡∏ß‡∏á‡∏ï‡∏≤ ‡∏à‡∏á‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô!'}],
      outroDialogueWin: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏à‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏´‡πà‡∏á‡∏ó‡∏∞‡πÄ‡∏•‡∏ó‡∏£‡∏≤‡∏¢‡∏°‡∏≤‡πÑ‡∏î‡πâ! ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡πà‡∏≤‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°'}],
      outroDialogueLose: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏†‡∏≤‡∏û‡∏•‡∏ß‡∏á‡∏ï‡∏≤‡∏°‡∏±‡∏ô‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î ‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞ ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πÄ‡∏à‡πâ‡∏≤‡∏≠‡∏≤‡∏à‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà'}]
    },
    // --- STAGE 7 ---
    {
      id: 's7', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 7: ‡∏´‡∏≠‡∏Ñ‡∏≠‡∏¢‡πÄ‡∏°‡∏Ü‡∏≤', worldName: '‡∏´‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏™‡∏π‡πà‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå',
      description: '‡∏õ‡∏µ‡∏ô‡∏´‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏™‡∏π‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏ü‡πâ‡∏≤ ‡∏ó‡∏µ‡πà‡∏ã‡∏∂‡πà‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏•‡∏°‡πÅ‡∏£‡∏á',
      operation: 'MIXED', numProblems: 6, enemyName: '‡∏Å‡∏£‡∏¥‡∏ü‡∏ü‡∏¥‡∏ô‡πÄ‡∏ß‡∏´‡∏≤', enemySprite: 'ü¶Ö', enemyMaxHp: 130,
      problemDifficultyMultiplier: 1.2,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏≤‡∏ß‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏¢‡∏¥‡πà‡∏á‡∏¢‡∏≤‡∏Å! ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏£‡∏á‡πÄ‡∏•‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-sky-200 border-sky-600', mapIcon: '‚òÅÔ∏è',
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏´‡∏≠‡∏Ñ‡∏≠‡∏¢‡πÄ‡∏°‡∏Ü‡∏≤‡∏ô‡∏µ‡πâ‡∏™‡∏π‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏ü‡πâ‡∏≤ ‡∏ß‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏î‡∏û‡∏¥‡∏ä‡∏¥‡∏ï‡πÑ‡∏î‡πâ ‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏´‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç'},
        { speakerSprite:'ü¶Ö', speakerName:'‡∏Å‡∏£‡∏¥‡∏ü‡∏ü‡∏¥‡∏ô‡πÄ‡∏ß‡∏´‡∏≤', text:'‡∏Å‡∏£‡∏£‡∏£! ‡∏ú‡∏π‡πâ‡πÉ‡∏î‡∏ö‡∏∏‡∏Å‡∏£‡∏∏‡∏Å‡∏≠‡∏≤‡∏ì‡∏≤‡πÄ‡∏Ç‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤! ‡∏à‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏ã‡∏∞!'}
      ],
      outroDialogueWin: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏à‡πâ‡∏≤‡∏ö‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î! ‡∏Å‡∏£‡∏¥‡∏ü‡∏ü‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß'}],
      outroDialogueLose: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏•‡∏°‡∏û‡∏≤‡∏¢‡∏∏‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡∏û‡∏±‡∏î‡πÅ‡∏£‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏™‡∏¥‡∏ô‡∏∞ ‡∏û‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà!'}]
    },
    // --- STAGE 8 ---
    {
      id: 's8', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 8: ‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÑ‡∏ü‡∏Ñ‡∏≥‡∏£‡∏≤‡∏°', worldName: '‡πÅ‡∏Å‡πà‡∏ô‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÑ‡∏ü‡∏û‡∏¥‡πÇ‡∏£‡∏ò',
      description: '‡∏•‡∏≤‡∏ß‡∏≤‡∏£‡πâ‡∏≠‡∏ô‡∏£‡∏∞‡∏≠‡∏∏‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡πÅ‡∏ú‡∏î‡πÄ‡∏ú‡∏≤ ‡∏õ‡∏∞‡∏ó‡∏∞‡∏†‡∏π‡∏ï‡∏≠‡∏±‡∏Ñ‡∏Ñ‡∏µ‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå',
      operation: 'MIXED', numProblems: 6, enemyName: '‡∏†‡∏π‡∏ï‡∏≠‡∏±‡∏Ñ‡∏Ñ‡∏µ‡πÇ‡∏Å‡∏£‡∏ò‡∏≤', enemySprite: 'üî•', enemyMaxHp: 140,
      problemDifficultyMultiplier: 1.3,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÑ‡∏ü‡∏ô‡∏µ‡πâ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏ï‡∏¥‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤! ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏ó‡∏µ‡πà‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á', sprite: 'ü¶â' },
      backgroundStyle: 'bg-red-200 border-red-600', mapIcon: 'üåã',
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÑ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ô‡πâ‡∏≠‡∏¢! ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏Å‡πà‡∏ô‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÑ‡∏ü ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏†‡∏π‡∏ï‡∏≠‡∏±‡∏Ñ‡∏Ñ‡∏µ‡πÄ‡∏ù‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà!'},
        { speakerSprite:'üî•', speakerName:'‡∏†‡∏π‡∏ï‡∏≠‡∏±‡∏Ñ‡∏Ñ‡∏µ', text:'‡∏ü‡∏π‡πà‡πà‡∏ß‡∏ß‡∏ß! ‡∏ú‡∏π‡πâ‡πÉ‡∏î‡∏Å‡∏•‡πâ‡∏≤‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤! ‡∏à‡∏á‡∏°‡∏≠‡∏î‡πÑ‡∏´‡∏°‡πâ‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏Å‡∏£‡∏ò‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏Ç‡πâ‡∏≤‡πÄ‡∏™‡∏µ‡∏¢!'}
      ],
      outroDialogueWin: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏à‡πâ‡∏≤‡∏î‡∏±‡∏ö‡πÑ‡∏ü‡πÇ‡∏Å‡∏£‡∏ò‡∏≤‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÑ‡∏î‡πâ! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏¢‡πá‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á‡∏ô‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ß!'} ],
      outroDialogueLose: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏ö‡∏™‡∏ô ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏à‡πÉ‡∏´‡πâ‡πÄ‡∏¢‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏π‡πâ‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞'} ]
    },
    // --- STAGE 9 ---
    {
      id: 's9', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 9: ‡∏ß‡∏¥‡∏´‡∏≤‡∏£‡πÉ‡∏ï‡πâ‡∏™‡∏°‡∏∏‡∏ó‡∏£', worldName: '‡∏ô‡∏Ñ‡∏£‡∏ö‡∏≤‡∏î‡∏≤‡∏•‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö',
      description: '‡πÑ‡∏Ç‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏ó‡πâ‡∏≠‡∏á‡∏ó‡∏∞‡πÄ‡∏•‡∏•‡∏∂‡∏Å ‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡∏ß‡∏¥‡∏´‡∏≤‡∏£‡πÇ‡∏ö‡∏£‡∏≤‡∏ì‡πÉ‡∏ï‡πâ‡πÄ‡∏Å‡∏•‡∏µ‡∏¢‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô',
      operation: 'MIXED', numProblems: 7, enemyName: '‡∏û‡∏£‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡∏ß‡∏¥‡∏´‡∏≤‡∏£', enemySprite: 'ü¶ë', enemyMaxHp: 160,
      specialAbility: 'hpDrain', abilityValue: 4,
      problemDifficultyMultiplier: 1.4,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏´‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡∏à‡∏á‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡πÅ‡∏£‡∏á‡∏Å‡∏î‡∏î‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏•‡∏∂‡∏Å!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-teal-200 border-teal-600', mapIcon: 'üåä',
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏ß‡∏¥‡∏´‡∏≤‡∏£‡πÉ‡∏ï‡πâ‡∏ô‡πâ‡∏≥‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢... ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏Å‡∏£‡∏á‡∏Ç‡∏≤‡∏°‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà'},
        { speakerSprite:'ü¶ë', speakerName:'‡∏û‡∏£‡∏≤‡∏¢‡∏ô‡πâ‡∏≥', text:'‡∏ã‡∏π‡πà...‡∏ã‡πà‡∏≤... ‡∏ú‡∏π‡πâ‡πÉ‡∏î‡∏•‡πà‡∏ß‡∏á‡∏•‡πâ‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏≠‡∏≤‡∏ì‡∏≤‡πÄ‡∏Ç‡∏ï‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤... ‡∏à‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏°‡∏î‡∏¥‡πà‡∏á‡∏™‡∏π‡πà‡∏Å‡πâ‡∏ô‡∏ö‡∏∂‡πâ‡∏á'}
      ],
      outroDialogueWin: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏à‡πâ‡∏≤‡πÑ‡∏Ç‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏´‡∏≤‡∏£‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏ô‡πâ‡∏≥‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÑ‡∏´‡∏•‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏à‡πâ‡∏≤'} ],
      outroDialogueLose: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏û‡∏•‡∏±‡∏á‡∏ô‡πâ‡∏≥‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏ö‡∏™‡∏ô ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏≥‡∏î‡∏¥‡πà‡∏á‡∏•‡∏á‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡∏°‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'} ]
    },
    // --- STAGE 10 ---
    {
      id: 's10', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 10: ‡∏õ‡πâ‡∏≠‡∏°‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏°‡∏∑‡∏î', worldName: '‡∏õ‡πâ‡∏≠‡∏°‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏∏‡∏ô‡∏û‡∏•‡∏ó‡∏°‡∏¥‡∏¨',
      description: '‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏Ç‡∏∏‡∏ô‡∏û‡∏•‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö ‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏î‡∏∏‡πÄ‡∏î‡∏∑‡∏≠‡∏î!',
      operation: 'MIXED', numProblems: 7, enemyName: '‡∏≠‡∏±‡∏®‡∏ß‡∏¥‡∏ô‡∏î‡∏≥‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏¥‡πâ‡∏ô‡∏´‡∏ß‡∏±‡∏á', enemySprite: 'üê¥', enemyMaxHp: 200,
      specialAbility: 'onDefeatDamage', abilityValue: 20, problemDifficultyMultiplier: 1.5,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç! ‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡∏≤‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏°‡∏≤‡∏Å!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-gray-700 border-gray-900', mapIcon: ' –∫—Ä–µ–ø–æ—Å—Ç—å', // Russian for fortress, example icon
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏õ‡πâ‡∏≠‡∏°‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏®‡∏ß‡∏¥‡∏ô‡∏î‡∏≥ ‡∏Ç‡∏∏‡∏ô‡∏û‡∏•‡∏ú‡∏π‡πâ‡∏†‡∏±‡∏Å‡∏î‡∏µ‡∏ï‡πà‡∏≠‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö! ‡∏à‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏î‡∏µ!'},
        { speakerSprite:'üê¥', speakerName:'‡∏≠‡∏±‡∏®‡∏ß‡∏¥‡∏ô‡∏î‡∏≥', text:'‡πÄ‡∏à‡πâ‡∏≤‡∏Å‡∏•‡πâ‡∏≤‡∏î‡∏µ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà! ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏¥‡πâ‡∏ô‡∏´‡∏ß‡∏±‡∏á‡∏à‡∏∞‡∏Å‡∏•‡∏∑‡∏ô‡∏Å‡∏¥‡∏ô‡πÄ‡∏à‡πâ‡∏≤!'}
      ],
      outroDialogueWin: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÅ‡∏™‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡∏≤! ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!'}],
      outroDialogueLose: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏á‡∏≤‡∏ó‡∏°‡∏¥‡∏¨‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡∏≤‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ! ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏¢‡∏±‡∏á‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà'}]
    },
    // --- STAGE 11 ---
    {
      id: 's11', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 11: ‡∏™‡∏∏‡∏™‡∏≤‡∏ô‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏¥‡∏¢‡πå‡∏ñ‡∏π‡∏Å‡∏•‡∏∑‡∏°', worldName: '‡∏´‡∏∏‡∏ö‡πÄ‡∏Ç‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏á‡∏±‡∏ô',
      description: '‡∏õ‡∏•‡∏∏‡∏Å‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì‡πÇ‡∏ö‡∏£‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏ö‡πÉ‡∏´‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏•‡∏±‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏™‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏≤‡∏ñ‡∏£‡∏£‡∏û‡πå!',
      operation: 'MIXED', numProblems: 7, enemyName: '‡∏ü‡∏≤‡πÇ‡∏£‡∏´‡πå‡∏≠‡∏≤‡∏Ñ‡∏°‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', enemySprite: 'üëª', enemyMaxHp: 220,
      specialAbility: 'onDefeatDamage', abilityValue: 25,
      problemDifficultyMultiplier: 1.6,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì‡πÉ‡∏ô‡∏™‡∏∏‡∏™‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡∏à‡∏á‡∏õ‡∏•‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏±‡∏ç‡∏ç‡∏≤!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-yellow-200 border-yellow-700',
      mapIcon: '‚ö∞Ô∏è',
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏™‡∏∏‡∏™‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏•‡∏∑‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏•‡πÄ‡∏ß‡∏•‡∏≤... ‡πÅ‡∏ï‡πà‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏ñ‡∏£‡∏£‡∏û‡πå‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà'},
        { speakerSprite:'üëª', speakerName:'‡∏ü‡∏≤‡πÇ‡∏£‡∏´‡πå', text:'‡πÉ‡∏Ñ‡∏£...‡πÉ‡∏Ñ‡∏£‡∏Å‡∏•‡πâ‡∏≤‡∏õ‡∏•‡∏∏‡∏Å‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏ö‡πÉ‡∏´‡∏•‡∏≠‡∏±‡∏ô‡∏¢‡∏≤‡∏ß‡∏ô‡∏≤‡∏ô... ‡∏à‡∏á‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≤...‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏≤‡∏õ‡πÅ‡∏´‡πà‡∏á‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ!'}
      ],
      outroDialogueWin: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à‡πÄ‡∏à‡πâ‡∏≤‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏™‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå'} ],
      outroDialogueLose: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏≠‡∏≤‡∏ñ‡∏£‡∏£‡∏û‡πå‡∏Ç‡∏≠‡∏á‡∏ü‡∏≤‡πÇ‡∏£‡∏´‡πå‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πÄ‡∏à‡πâ‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≥‡∏™‡∏≤‡∏õ‡πÑ‡∏î‡πâ'} ]
    },
    // --- STAGE 12 ---
    {
      id: 's12', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 12: ‡∏ô‡∏Ñ‡∏£‡πÄ‡∏°‡∏Ü‡∏≤‡∏•‡∏≠‡∏¢‡∏ü‡πâ‡∏≤', worldName: '‡∏≠‡∏≤‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÄ‡∏°‡∏Ü',
      description: '‡∏ô‡∏Ñ‡∏£‡∏™‡∏π‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏ü‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡πÄ‡∏ß‡∏´‡∏≤ ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏•‡∏Ç‡∏à‡∏∞‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏î‡∏∏‡∏à‡∏™‡∏≤‡∏¢‡∏•‡∏°',
      operation: 'MIXED', numProblems: 8, enemyName: '‡∏≠‡∏™‡∏π‡∏£‡πÄ‡∏ß‡∏´‡∏≤‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡∏ô‡∏Ñ‡∏£', enemySprite: 'üå™Ô∏è', enemyMaxHp: 240,
      problemDifficultyMultiplier: 1.75,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏ì ‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡πÅ‡∏´‡πà‡∏á‡∏ô‡∏µ‡πâ ‡∏™‡∏ï‡∏¥‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î! ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏û‡∏≤‡∏¢‡∏∏‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-sky-300 border-sky-700',
      mapIcon: 'üè∞',
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏ô‡∏Ñ‡∏£‡πÄ‡∏°‡∏Ü‡∏≤... ‡∏ß‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ñ‡∏¥‡∏ï‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡πÇ‡∏ö‡∏£‡∏≤‡∏ì ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏Ñ‡∏≠‡∏¢‡∏î‡∏π‡πÅ‡∏•'},
        { speakerSprite:'üå™Ô∏è', speakerName:'‡∏≠‡∏™‡∏π‡∏£‡πÄ‡∏ß‡∏´‡∏≤', text:'‡∏ã‡∏π‡πà‡∏ß‡∏ß‡∏ß‡∏ß! ‡πÄ‡∏à‡πâ‡∏≤‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å ‡∏Å‡∏•‡πâ‡∏≤‡∏î‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏≠‡∏≤‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤! ‡∏à‡∏á‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ß‡πà‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏Ñ‡∏ß‡∏£!'}
      ],
      outroDialogueWin: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏¥‡∏ä‡∏¥‡∏ï‡∏ô‡∏Ñ‡∏£‡πÄ‡∏°‡∏Ü‡∏≤‡πÑ‡∏î‡πâ! ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏π‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ç‡∏±‡πâ‡∏ô! ‡∏™‡∏≤‡∏¢‡∏•‡∏°‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÄ‡∏à‡πâ‡∏≤!'} ],
      outroDialogueLose: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏û‡∏≤‡∏¢‡∏∏‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏ô‡∏±‡∏Å ‡∏•‡∏≠‡∏á‡∏™‡∏á‡∏ö‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏∞‡∏¢‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡πÉ‡∏´‡∏°‡πà'} ]
    },
    // --- STAGE 13 ---
    {
      id: 's13', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 13: ‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡∏£‡∏ò‡∏≤‡∏ï‡∏∏‡∏ß‡∏¥‡∏õ‡∏•‡∏≤‡∏™', worldName: '‡∏´‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡∏£‡∏ò‡∏≤‡∏ï‡∏∏',
      description: '‡∏™‡∏π‡∏ï‡∏£‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏™‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡∏£‡∏ò‡∏≤‡∏ï‡∏∏‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô!',
      operation: 'MIXED', numProblems: 8, enemyName: '‡∏™‡∏≤‡∏£‡∏ú‡∏™‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£', enemySprite: 'üß™', enemyMaxHp: 260,
      specialAbility: 'attackUpOnHit', abilityValue: 4,
      problemDifficultyMultiplier: 1.85,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡∏£‡∏ò‡∏≤‡∏ï‡∏∏‡∏ú‡∏π‡πâ‡∏ô‡∏µ‡πâ‡∏´‡∏•‡∏á‡πÉ‡∏´‡∏•‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ! ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-purple-200 border-purple-600',
      mapIcon: '‚öóÔ∏è',
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á... ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡∏£‡∏ò‡∏≤‡∏ï‡∏∏‡∏ú‡∏π‡πâ‡∏´‡∏°‡∏Å‡∏°‡∏∏‡πà‡∏ô‡πÉ‡∏ô‡πÄ‡∏•‡∏Ç‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå'},
        { speakerSprite:'üß™', speakerName:'‡∏™‡∏≤‡∏£‡∏ú‡∏™‡∏°', text:'‡∏ü‡∏π‡πà...‡∏ü‡∏π‡πà...‡∏õ‡∏∏‡∏î‡πÜ...‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì...‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á...!!'}
      ],
      outroDialogueWin: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏à‡πâ‡∏≤‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏Å‡∏•‡∏≤‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÑ‡∏î‡πâ! ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ! ‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß'} ],
      outroDialogueLose: [ { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤! ‡∏à‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞'} ]
    },
    // --- STAGE 14 ---
    {
      id: 's14', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 14: ‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢', worldName: '‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏ö‡∏£‡∏≤‡∏ä‡∏≤',
      description: '‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö ‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏Å‡∏©‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡∏ó‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà',
      operation: 'MIXED', numProblems: 8, enemyName: '‡πÇ‡∏Å‡πÄ‡∏•‡∏°‡∏®‡∏¥‡∏•‡∏≤‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', enemySprite: 'üóø', enemyMaxHp: 280,
      specialAbility: 'damageResist', abilityValue: 5, problemDifficultyMultiplier: 2.0,
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏£‡∏≤‡∏ä‡∏≤! ‡∏à‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏°‡∏µ!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-purple-300 border-purple-700', mapIcon: 'üõ°Ô∏è',
      introDialogue: [
        { speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏ö‡∏ó‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö ‡πÇ‡∏Å‡πÄ‡∏•‡∏°‡∏®‡∏¥‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏ó‡πÇ‡∏ö‡∏£‡∏≤‡∏ì!'},
        { speakerSprite:'üóø', speakerName:'‡πÇ‡∏Å‡πÄ‡∏•‡∏°‡∏®‡∏¥‡∏•‡∏≤', text:'‡∏ú‡∏π‡πâ...‡∏ö‡∏∏‡∏Å‡∏£‡∏∏‡∏Å...‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á...‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô...!'}
      ],
      outroDialogueWin: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡πÄ‡∏à‡πâ‡∏≤‡∏ó‡∏•‡∏≤‡∏¢‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏®‡∏¥‡∏•‡∏≤‡πÑ‡∏î‡πâ! ‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß!'}],
      outroDialogueLose: [{speakerSprite:'ü¶â', speakerName:'‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå', text:'‡∏û‡∏•‡∏±‡∏á‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏î‡∏∏‡∏à‡∏´‡∏¥‡∏ô‡∏ú‡∏≤ ‡πÅ‡∏ï‡πà‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏¢‡πà‡∏≠‡∏°‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô ‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡∏π‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞'}]
    },
    // --- STAGE 15 (Final Boss) ---
    {
      id: 's15', name: '‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 15: ‡∏ö‡∏±‡∏•‡∏•‡∏±‡∏á‡∏Å‡πå‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö', worldName: '‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó‡∏ó‡∏°‡∏¥‡∏¨‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á',
      description: '‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢! ‡∏à‡∏á‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡πà‡∏ô‡∏£‡∏≤‡∏ä‡∏≤‡∏õ‡∏µ‡∏®‡∏≤‡∏à‡πÄ‡∏•‡∏Ç‡∏•‡∏ö!',
      operation: 'MIXED', numProblems: 10, // Example: 10 hard problems for the boss
      enemyName: '‡∏£‡∏≤‡∏ä‡∏≤‡∏õ‡∏µ‡∏®‡∏≤‡∏à‡πÄ‡∏•‡∏Ç‡∏•‡∏ö', enemySprite: 'üòà', enemyMaxHp: 500, // High HP
      specialAbility: 'onDefeatDamage', abilityValue: 25, // Final attack
      problemDifficultyMultiplier: 2.5, // Hardest problems
      companion: { name: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', advice: '‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó! ‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏Ç‡∏≠‡∏á Numeria ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡πÄ‡∏à‡πâ‡∏≤!', sprite: 'ü¶â' },
      backgroundStyle: 'bg-black border-red-600', mapIcon: 'üëë',
      introDialogue: [
        { speakerSprite: 'ü¶â', speakerName: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', text: '‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î... ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡∏±‡∏•‡∏•‡∏±‡∏á‡∏Å‡πå‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô... ‡∏£‡∏≤‡∏ä‡∏≤‡∏õ‡∏µ‡∏®‡∏≤‡∏à‡πÄ‡∏•‡∏Ç‡∏•‡∏ö!' },
        { speakerSprite: 'üòà', speakerName: '‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö', text: '‡∏Æ‡πà‡∏≤‡πÜ‡πÜ‡πÜ! ‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏î‡πá‡∏Å‡πÇ‡∏á‡πà‡πÄ‡∏Ç‡∏•‡∏≤! ‡∏Ñ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏≤‡∏´‡∏¢‡∏∏‡∏î‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡∏ß‡∏∏‡πà‡∏ô‡∏ß‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏à‡∏∞‡∏Å‡∏•‡∏∑‡∏ô‡∏Å‡∏¥‡∏ô‡πÄ‡∏à‡πâ‡∏≤!' },
        { speakerSprite: 'üßô', speakerName: '‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î', text: '‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ô‡∏ï‡∏¥‡∏™‡∏∏‡∏Ç‡∏Ç‡∏≠‡∏á Numeria! ‡∏Ç‡πâ‡∏≤‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞‡∏ó‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ!' }
      ],
      outroDialogueWin: [
        { speakerSprite: 'üßô', speakerName: '‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î', text: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß...! ‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö‡∏ñ‡∏π‡∏Å‡∏õ‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡πâ‡∏ß!' },
        { speakerSprite: 'ü¶â', speakerName: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', text: '‡πÄ‡∏à‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏î‡πâ! ‡πÄ‡∏à‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏µ‡∏£‡∏ö‡∏∏‡∏£‡∏∏‡∏©‡∏ú‡∏π‡πâ‡∏õ‡∏•‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢ Numeria! ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÑ‡∏î‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß!' }
      ],
      outroDialogueLose: [
        { speakerSprite: 'üòà', speakerName: '‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö', text: '‡∏≠‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏î‡∏ô‡∏±‡∏Å! Numeria ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏°‡∏î‡∏¥‡πà‡∏á‡∏™‡∏π‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏°‡∏¥‡∏î‡πÅ‡∏´‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ï‡πà‡∏≠‡πÑ‡∏õ! ‡∏Æ‡πà‡∏≤‡πÜ‡πÜ!' },
        { speakerSprite: 'ü¶â', speakerName: '‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡πÇ‡∏ö‡∏£‡∏≤‡∏ì', text: '‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏°‡∏´‡∏≤‡∏®‡∏≤‡∏•‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ... ‡πÅ‡∏ï‡πà‡∏ï‡∏£‡∏≤‡∏ö‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏∏‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏π‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á!' }
      ]
    }
  ];

  const initializedStages: Stage[] = stagesData.map(stageConfig => {
    const { problemDifficultyMultiplier, ...restOfStageData } = stageConfig;
    
    const problems: Problem[] = generateProblemsForStage(
        restOfStageData.id, 
        restOfStageData.operation, 
        restOfStageData.numProblems, 
        globalGeneratedProblemSignatures,
        problemDifficultyMultiplier || 1 // Use the multiplier if provided, else default to 1
    );
    
    return {
      ...restOfStageData,
      problems,
    } as Stage; // Cast to Stage as problemDifficultyMultiplier is now removed.
  });

  return initializedStages;
}

export const TUTORIAL_TEXT = [
  "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Math Quest: ‡∏î‡∏¥‡∏ô‡πÅ‡∏î‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!",
  `‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ú‡πà‡∏≤‡∏ô ${initializeGameStages().length} ‡∏î‡πà‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏≤‡∏ö‡∏£‡∏≤‡∏ä‡∏≤‡∏õ‡∏µ‡∏®‡∏≤‡∏à‡πÄ‡∏•‡∏Ç‡∏•‡∏ö`,
  "‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ: ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πà‡∏≤‡∏ô‡∏°‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π 1 ‡∏ï‡∏±‡∏ß ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏à‡∏∞‡∏°‡∏µ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏•‡∏Ç‡∏´‡∏•‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠ (‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏î‡πà‡∏≤‡∏ô) ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ",
  "‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å: ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π! ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö '‡∏û‡∏•‡∏±‡∏á‡∏™‡∏°‡∏≤‡∏ò‡∏¥'",
  "‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏î: ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ ‡πÄ‡∏™‡∏µ‡∏¢ HP ‚ù§Ô∏è ‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)",
  "‡∏ä‡∏ô‡∏∞‡∏î‡πà‡∏≤‡∏ô: ‡πÄ‡∏°‡∏∑‡πà‡∏≠ HP ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏´‡∏°‡∏î‡∏•‡∏á",
  "‡πÅ‡∏û‡πâ‡∏î‡πà‡∏≤‡∏ô: ‡πÄ‡∏°‡∏∑‡πà‡∏≠ HP ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏´‡∏°‡∏î ‡∏´‡∏£‡∏∑‡∏≠ ‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡πÉ‡∏ô‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà HP ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î",
  "‡∏û‡∏•‡∏±‡∏á‡∏™‡∏°‡∏≤‡∏ò‡∏¥: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏° ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ '‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏û‡∏¥‡πÄ‡∏®‡∏©' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏•‡∏±‡∏á‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ!",
  `‡πÇ‡∏ö‡∏ô‡∏±‡∏™: ‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡πá‡∏ß‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ${QUICK_ANSWER_THRESHOLD_SECONDS} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏£‡∏±‡∏ö ${QUICK_ANSWER_BONUS_SCORE} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©!`,
  "‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©: ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏ö‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏î‡∏µ!",
  "HP ‡∏´‡∏°‡∏î: ‡πÄ‡∏Å‡∏°‡πÇ‡∏≠‡πÄ‡∏ß‡∏≠‡∏£‡πå ‡πÅ‡∏ï‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ (HP ‡∏à‡∏∞‡∏ü‡∏∑‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î '‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á')",
  "‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°: ‡πÉ‡∏ä‡πâ üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ (Hint) ‡∏´‡∏£‡∏∑‡∏≠ üß™ ‡∏¢‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏•‡∏±‡∏á (Potion)",
  "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å, ‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡πá‡∏ß, ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô",
  "‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏•‡∏Ç‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏Å‡∏°‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô!",
  "‡∏ö‡∏ó‡∏™‡∏ô‡∏ó‡∏ô‡∏≤: ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ",
  "‡∏Ñ‡∏±‡∏ó‡∏ã‡∏µ‡∏ô: ‡∏£‡∏±‡∏ö‡∏ä‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!",
  "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏ô‡∏∏‡∏Å‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏ù‡∏∂‡∏Å‡∏™‡∏°‡∏≠‡∏á‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡∏ô‡∏∞!"
];

export const PLAYER_ATTACK_POWER = 15; // Base damage per correct answer
export const ENEMY_ATTACK_POWER = 12; // Base damage from enemy
// Boss/Miniboss specific power can be tuned via their base HP and numProblems, or special abilities

export const GAME_INTRO_CUTSCENE_ID = 'gameIntro';

export const CUTSCENES: { [key: string]: Cutscene } = {
  [GAME_INTRO_CUTSCENE_ID]: [
    {
      id: 'intro1',
      backgroundStyle: 'bg-gradient-to-br from-sky-400 to-blue-600',
      elements: [
        { 
          type: 'text', 
          text: '‡∏ì ‡∏î‡∏¥‡∏ô‡πÅ‡∏î‡∏ô Numeria ‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏ö‡∏™‡∏∏‡∏Ç...', 
          // Responsive text size added here
          positionClasses: 'absolute top-1/3 left-1/2 -translate-x-1/2 text-white text-xl sm:text-2xl md:text-3xl font-bold text-center p-3 sm:p-4 md:p-6 bg-black/40 rounded-xl shadow-2xl', 
          animationClasses: 'animate-fade-in opacity-0'
        },
      ],
      autoAdvanceDelay: 3500,
    },
    {
      id: 'intro2',
      backgroundStyle: 'bg-gradient-to-br from-red-700 via-red-500 to-orange-600',
      elements: [
        { 
          type: 'character', 
          sprite: 'üòà', 
          name: '‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏•‡∏Ç‡∏•‡∏ö', 
          // Character sprite size is already responsive in CutsceneScreen.tsx via text-7xl md:text-8xl
          positionClasses: 'absolute top-1/4 left-1/2 -translate-x-1/2', 
          animationClasses: 'animate-bounce' 
        },
        { 
          type: 'text', 
          text: '‡∏ó‡∏±‡∏ô‡πÉ‡∏î‡∏ô‡∏±‡πâ‡∏ô... ‡∏£‡∏≤‡∏ä‡∏≤‡∏õ‡∏µ‡∏®‡∏≤‡∏à‡πÄ‡∏•‡∏Ç‡∏•‡∏ö üòà ‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô!', 
          // Responsive text size
          positionClasses: 'absolute bottom-1/4 left-1/2 -translate-x-1/2 text-white text-lg sm:text-xl md:text-2xl text-center p-2 sm:p-3 md:p-4 bg-black/60 rounded-lg shadow-xl', 
          animationClasses: 'animate-fade-in opacity-0' 
        },
        { 
          type: 'text', 
          text: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏Å‡∏•‡∏≤‡∏´‡∏•‡πÑ‡∏õ‡∏ó‡∏±‡πà‡∏ß‡∏î‡∏¥‡∏ô‡πÅ‡∏î‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏•‡∏±‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î!', 
          // Responsive text size
          positionClasses: 'absolute bottom-10 sm:bottom-12 md:bottom-16 left-1/2 -translate-x-1/2 text-yellow-300 text-base sm:text-lg md:text-xl text-center px-2', 
          animationClasses: 'animate-fade-in opacity-0'
        },
      ],
      autoAdvanceDelay: 5000,
    },
    {
      id: 'intro3',
      backgroundStyle: 'bg-gradient-to-br from-green-400 to-teal-500',
      elements: [
        { 
          type: 'character', 
          sprite: 'üßô', 
          name: '‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î', 
          // Character sprite size is already responsive
          positionClasses: 'absolute top-1/2 left-1/4 -translate-y-1/2 opacity-0',
          animationClasses: 'animate-slide-in-left' 
        },
        { 
          type: 'text', 
          text: '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏π... üßô\n‡∏ô‡∏±‡∏Å‡πÄ‡∏ß‡∏ó‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç...\n‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Å‡∏•‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô‡∏°‡∏≤!', 
          // Responsive text and padding
          positionClasses: 'absolute top-1/2 right-1/4 -translate-y-1/2 text-indigo-800 text-sm sm:text-base md:text-xl font-semibold p-3 sm:p-4 md:p-6 bg-white/80 rounded-xl shadow-2xl text-center opacity-0', 
          animationClasses: 'animate-slide-in-right'
        },
      ],
    }
    // Add more frames for richer story
  ]
  // You can add more cutscenes here, e.g. for mid-game events or before the final boss
  // 'beforeFinalBoss': [ ...frames... ]
};
